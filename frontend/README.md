#### You are on the improved search branch
Which is still underdevelopment

# Overview
The goal of this branch is to address issue #80, improving the search functionality, of dee2.
This will be achieved with:

 - [Elasticsearch](https://www.elastic.co/) to index the metadata generated by the dee2 pipeline.
 - Python (>=3.6) server running [aiohttp](https://docs.aiohttp.org/en/stable/) which will interface with Elasticseach
    using the provided client [package](https://elasticsearch-py.readthedocs.io/en/master/). In production
    this will sit behind the Apache server (requiring additional configuration).
 - [Elm](https://elm-lang.org/) will be used for the end user web UI. Hopefully this strictly typed checked
    language will help avoid unnecessary bugs.
 - [Bootstrap](https://getbootstrap.com/) Is used to streamline styling and design
 - [Parcel](https://parceljs.org/) is used to build Elm code into static files to be served.
     

# Setting up the development environment

- [Install](https://www.elastic.co/elasticsearch/?ultron=B-Stack-Trials-APJ-ANZ-Exact&gambit=Elasticsearch-install&blade=adwords-s&thor=install%20elasticsearch&gclid=CjwKCAjwoc_8BRAcEiwAzJevtU6L3dCJk-oDzUodHfZJwMW8L6nxFYBa9S6MR-LGmHewnPl4ds6oLRoCaLsQAvD_BwE) 
    Elasticsearch. The location of which may not matter in development, 
    however consideration will need to be made for production
    ###### Note: You may need to install Java
    
- [install](https://www.python.org/) Python (>=3.6)
- [install](https://elm-lang.org/) Elm (0.19)
- [install](https://parceljs.org/getting_started.html) Parcel

- #### Install dependencies for server.py
    Using a virtual environment is normally recommended 
    (however can be a pain having to constantly activate it).
    
    `$pip install aiohttp`
    
    `$pip install elasticsearch`
    
- #### Run Elasticsearch
    On Windows this will be by running `elasticsearch.exe` found in
    `C:\Program Files\Elastic\Elasticsearch\7.9.2\bin` install location
    will vary depending on OS/install method (package manager/ tar.gz)
    
- #### Index the metadata files
    - Set the DEE2_METADATA_DIR environment variable to the location of the 
        `.tsv` files.
    - Run `ingest.py` script
        `python ingest.py` | `python3.6 ingest.py`. Expect this to take 5-6min 

- #### Start parcel watching for files changes.
    `$parcel watch index.html`
    
- #### Run the python server
    Note: Activate the virtual environmet if using one
    
    `$python server.py` | `python3.6 server.py`

- Navigate to `http://localhost:8080/` in your browser

## Running Tests

 - Install [elm-spec](https://package.elm-lang.org/packages/brian-watkins/elm-spec/latest/) 
 
 - Install test runner `$npm install --save-dev elm-spec-runner
`
 - Run `$npx elm-spec` from dee2/frontend
